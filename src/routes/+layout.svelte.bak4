<script>
    import { page } from '$app/stores';
    import { onMount } from 'svelte';
    import '../app.css';

    export let data;

    let searchQuery = '';
    let isCollapsed = false;
    let wishlistCount = 0;
    let compareCount = 0;
    let mobileMenuOpen = false;
    let megaMenuOpen = false;
    let activeCategoryId = null;
    let activeCategoryData = null;
    let closeTimeout = null;
    let showAllCats = false;
    let catNavStyle = 'pills';
    const MAX_VISIBLE = 10;

    $: navCategories = (data?.navCategories || []).map(cat => {
        const children = (cat.children || []).map(child => {
            const grandchildren = (child.children || []).slice(0, 15);
            return { ...child, grandchildren };
        });
        return { ...cat, children };
    });
    $: visibleCats = navCategories.slice(0, MAX_VISIBLE);
    $: hiddenCats = navCategories.slice(MAX_VISIBLE);
    $: hasMore = hiddenCats.length > 0;

    function handleSearch(e) { e.preventDefault(); if (searchQuery.trim()) window.location.href = `/hladat?q=${encodeURIComponent(searchQuery)}`; }
    function closeMobileMenu() { mobileMenuOpen = false; document.body.style.overflow = ''; }
    function openMegaMenu(cat) { if (closeTimeout) { clearTimeout(closeTimeout); closeTimeout = null; } if (cat.children && cat.children.length > 0) { activeCategoryId = cat.id; activeCategoryData = cat; megaMenuOpen = true; } }
    function scheduleMegaClose() { closeTimeout = setTimeout(() => { megaMenuOpen = false; activeCategoryId = null; activeCategoryData = null; }, 200); }
    function cancelMegaClose() { if (closeTimeout) { clearTimeout(closeTimeout); closeTimeout = null; } }
    function handleCatEnter(cat) { if (window.innerWidth > 768) openMegaMenu(cat); }
    function handleCatLeave() { if (window.innerWidth > 768) scheduleMegaClose(); }
    function toggleAllCats() { showAllCats = !showAllCats; }
    function closeAllCats() { showAllCats = false; }

    onMount(() => {
        const SCROLL_THRESHOLD = 200; const HYSTERESIS = 50; let collapsed = false; let ticking = false;
        const update = () => { const y = window.scrollY || 0; if (y > SCROLL_THRESHOLD && !collapsed) { collapsed = true; isCollapsed = true; } else if (y < (SCROLL_THRESHOLD - HYSTERESIS) && collapsed) { collapsed = false; isCollapsed = false; } ticking = false; };
        const onScroll = () => { if (!ticking) { requestAnimationFrame(update); ticking = true; } };
        update(); window.addEventListener('scroll', onScroll, { passive: true });
        try { const saved = localStorage.getItem('mp_catnav_style'); if (saved && ['pills','icons','minimal','cards'].includes(saved)) catNavStyle = saved; } catch(e) {}
        return () => { window.removeEventListener('scroll', onScroll); if (closeTimeout) clearTimeout(closeTimeout); };
    });

    $: if (typeof window !== 'undefined' && catNavStyle) { try { localStorage.setItem('mp_catnav_style', catNavStyle); } catch(e) {} }

    const catEmojis = { 'uncategorized': 'ğŸ“¦', 'dom': 'ğŸ¡', 'zÃ¡hrada': 'ğŸ¡', 'domÃ¡ce': 'ğŸ”Œ', 'spotrebiÄe': 'ğŸ”Œ', 'elektronika': 'ğŸ“±', 'hraÄky': 'ğŸ§¸', 'kancelÃ¡rske': 'ğŸ“', 'kostÃ½my': 'ğŸ­', 'kuchynskÃ©': 'ğŸ³', 'ostatnÃ©': 'ğŸ“¦', 'Å¡port': 'âš½', 'zdravie': 'ğŸ’Š', 'krÃ¡sa': 'ğŸ’„', 'zvieratÃ¡': 'ğŸ¾', 'vonkajÅ¡ie': 'ğŸŒ³', 'auto': 'ğŸš—', 'dieÅ¥a': 'ğŸ‘¶', 'obleÄenie': 'ğŸ‘•', 'nÃ¡bytok': 'ğŸª‘', 'foto': 'ğŸ“¸', 'audio': 'ğŸ§', 'digitÃ¡l': 'ğŸ’»', 'hobby': 'ğŸ¨', 'hry': 'ğŸ®', 'camping': 'â›º', 'barbecue': 'ğŸ”¥', 'baby': 'ğŸ‘¶', 'beveilig': 'ğŸ”’', 'accessoire': 'ğŸ‘œ' };
    function getCatEmoji(name) { const lower = (name || '').toLowerCase(); for (const [key, emoji] of Object.entries(catEmojis)) { if (lower.includes(key)) return emoji; } return 'ğŸ“¦'; }
    function getInitial(name) { return (name || 'K').charAt(0).toUpperCase(); }
</script>

{#if $page.url.pathname.startsWith('/admin') || $page.url.pathname.startsWith('/vendor-dashboard')}
    <slot />
{:else}
<div class="mp-site">
    <!-- HEADER -->
    <header class="mp-header">
        <div class="mp-header__inner">
            <a href="/" class="mp-header__logo"><span class="mp-header__logo-text">megaprice</span></a>
            <form class="mp-search" on:submit={handleSearch}>
                <input type="text" class="mp-search__input" placeholder="HÄ¾adaj produkt, znaÄku..." bind:value={searchQuery}>
                <button type="submit" class="mp-search__btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    <span>HÄ¾adaÅ¥</span>
                </button>
            </form>
            <nav class="mp-header__actions">
                <a href="/ucet" class="mp-header__action">
                    <span class="mp-header__action-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span>
                    <span>MÃ´j ÃºÄet</span>
                </a>
                <a href="/oblubene" class="mp-header__action">
                    <span class="mp-header__action-icon">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                        {#if wishlistCount > 0}<span class="mp-header__action-badge">{wishlistCount}</span>{/if}
                    </span>
                    <span>ObÄ¾ÃºbenÃ©</span>
                </a>
                <a href="/porovnanie" class="mp-header__action">
                    <span class="mp-header__action-icon">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 2l4 4-4 4"/><path d="M3 6h18"/><path d="M7 14l-4 4 4 4"/><path d="M21 18H3"/></svg>
                        {#if compareCount > 0}<span class="mp-header__action-badge mp-header__action-badge--blue">{compareCount}</span>{/if}
                    </span>
                    <span>PorovnaÅ¥</span>
                </a>
                <a href="/kosik" class="mp-header__action mp-header__action--cart">
                    <span class="mp-header__action-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg></span>
                    <span>KoÅ¡Ã­k</span>
                </a>
            </nav>
        </div>
    </header>

    <!-- CATEGORY NAV -->
    <nav class="cn" class:cn--collapsed={isCollapsed}>
        <div class="cn__wrap">

            <!-- â•â•â• PILLS â•â•â• -->
            {#if catNavStyle === 'pills'}
            <div class="cn__row">
                {#each visibleCats as cat}
                    <a href={"/kategoria/" + (cat.slug || cat.id)} class="cn-pill"
                        class:cn-pill--active={activeCategoryId === cat.id}
                        on:mouseenter={() => handleCatEnter(cat)} on:mouseleave={handleCatLeave}>
                        <span class="cn-pill__ico">
                            {#if cat.image_url}<img src={cat.image_url} alt="">{:else}<span>{getCatEmoji(cat.name)}</span>{/if}
                        </span>
                        <span class="cn-pill__txt">{cat.name}</span>
                    </a>
                {/each}
                {#if hasMore}
                    <button class="cn-pill cn-pill--more" on:click={toggleAllCats}>
                        <span class="cn-pill__ico"><span class="cn-pill__plus">+{hiddenCats.length}</span></span>
                        <span class="cn-pill__txt">Viac</span>
                        <svg class="cn-pill__chevron" class:cn-pill__chevron--open={showAllCats} width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                {/if}
            </div>

            <!-- â•â•â• ICONS â•â•â• -->
            {:else if catNavStyle === 'icons'}
            <div class="cn__row cn__row--icons">
                {#each visibleCats as cat}
                    <a href={"/kategoria/" + (cat.slug || cat.id)} class="cn-ico"
                        class:cn-ico--active={activeCategoryId === cat.id}
                        on:mouseenter={() => handleCatEnter(cat)} on:mouseleave={handleCatLeave}>
                        <div class="cn-ico__circle">
                            {#if cat.image_url}<img src={cat.image_url} alt="">{:else}<span>{getCatEmoji(cat.name)}</span>{/if}
                        </div>
                        <span class="cn-ico__name">{cat.name}</span>
                    </a>
                {/each}
                {#if hasMore}
                    <button class="cn-ico cn-ico--more" on:click={toggleAllCats}>
                        <div class="cn-ico__circle cn-ico__circle--more">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="5" y1="12" x2="19" y2="12"/><line x1="12" y1="5" x2="12" y2="19"/></svg>
                        </div>
                        <span class="cn-ico__name">VÅ¡etky</span>
                    </button>
                {/if}
            </div>

            <!-- â•â•â• MINIMAL â•â•â• -->
            {:else if catNavStyle === 'minimal'}
            <div class="cn__row cn__row--min">
                {#each visibleCats as cat}
                    <a href={"/kategoria/" + (cat.slug || cat.id)} class="cn-min"
                        class:cn-min--active={activeCategoryId === cat.id}
                        on:mouseenter={() => handleCatEnter(cat)} on:mouseleave={handleCatLeave}>
                        {cat.name}
                    </a>
                {/each}
                {#if hasMore}
                    <button class="cn-min cn-min--more" on:click={toggleAllCats}>
                        Viac â†’
                    </button>
                {/if}
            </div>

            <!-- â•â•â• CARDS â•â•â• -->
            {:else if catNavStyle === 'cards'}
            <div class="cn__row cn__row--cards">
                {#each visibleCats as cat}
                    <a href={"/kategoria/" + (cat.slug || cat.id)} class="cn-card"
                        class:cn-card--active={activeCategoryId === cat.id}
                        on:mouseenter={() => handleCatEnter(cat)} on:mouseleave={handleCatLeave}>
                        <div class="cn-card__img">
                            {#if cat.image_url}<img src={cat.image_url} alt="">{:else}<span>{getCatEmoji(cat.name)}</span>{/if}
                        </div>
                        <span class="cn-card__name">{cat.name}</span>
                    </a>
                {/each}
                {#if hasMore}
                    <button class="cn-card cn-card--more" on:click={toggleAllCats}>
                        <div class="cn-card__img"><span>+{hiddenCats.length}</span></div>
                        <span class="cn-card__name">Viac</span>
                    </button>
                {/if}
            </div>
            {/if}

        </div>

        <!-- MEGA MENU -->
        {#if megaMenuOpen && activeCategoryData}
            <div class="mn" on:mouseenter={cancelMegaClose} on:mouseleave={scheduleMegaClose}>
                <div class="mn__grid">
                    {#each activeCategoryData.children || [] as sub}
                        <div class="mn__col">
                            <a href={"/kategoria/" + (sub.slug || sub.id)} class="mn__sub">
                                <div class="mn__sub-img">
                                    {#if sub.image_url}<img src={sub.image_url} alt="">
                                    {:else}<span>{getInitial(sub.name)}</span>{/if}
                                </div>
                                <span class="mn__sub-name">{sub.name}</span>
                            </a>
                            {#if sub.grandchildren?.length}
                                <div class="mn__links">
                                    {#each sub.grandchildren.slice(0, 8) as gc}
                                        <a href={"/kategoria/" + (gc.slug || gc.id)} class="mn__link">{gc.name}</a>
                                    {/each}
                                    {#if sub.grandchildren.length > 8}
                                        <a href={"/kategoria/" + (sub.slug || sub.id)} class="mn__link mn__link--more">+ ÄalÅ¡ie</a>
                                    {/if}
                                </div>
                            {/if}
                        </div>
                    {/each}
                </div>
            </div>
        {/if}

        <!-- ALL CATEGORIES DROPDOWN -->
        {#if showAllCats}
            <div class="cn-drop__overlay" on:click={closeAllCats}></div>
            <div class="cn-drop">
                <div class="cn-drop__head">
                    <h3>VÅ¡etky kategÃ³rie ({navCategories.length})</h3>
                    <button on:click={closeAllCats}>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    </button>
                </div>
                <div class="cn-drop__grid">
                    {#each navCategories as cat}
                        <a href={"/kategoria/" + (cat.slug || cat.id)} class="cn-drop__item" on:click={closeAllCats}>
                            <div class="cn-drop__item-img">
                                {#if cat.image_url}<img src={cat.image_url} alt="">
                                {:else}<span>{getCatEmoji(cat.name)}</span>{/if}
                            </div>
                            <div>
                                <span class="cn-drop__item-name">{cat.name}</span>
                                {#if cat.children?.length}
                                    <span class="cn-drop__item-count">{cat.children.length} podkategÃ³riÃ­</span>
                                {/if}
                            </div>
                        </a>
                    {/each}
                </div>
            </div>
        {/if}
    </nav>

    <main class="mp-main"><slot /></main>

    <!-- FOOTER -->
    <footer class="mp-footer">
        <div class="mp-footer__top"><div class="mp-footer__inner"><div class="mp-footer__grid">
            <div class="mp-footer__col"><h4>O nÃ¡s</h4><ul><li><a href="/o-nas">O MegaPrice</a></li><li><a href="/kontakt">Kontakt</a></li><li><a href="/kariera">KariÃ©ra</a></li></ul></div>
            <div class="mp-footer__col"><h4>Pre zÃ¡kaznÃ­kov</h4><ul><li><a href="/ako-nakupovat">Ako nakupovaÅ¥</a></li><li><a href="/obchodne-podmienky">ObchodnÃ© podmienky</a></li><li><a href="/ochrana-udajov">Ochrana Ãºdajov</a></li></ul></div>
            <div class="mp-footer__col"><h4>Pre predajcov</h4><ul><li><a href="/prihlasenie-predajcu">PrihlÃ¡senie predajcu</a></li><li><a href="/registracia-predajcu">RegistrÃ¡cia predajcu</a></li><li><a href="/ako-to-funguje">Ako to funguje</a></li></ul></div>
            <div class="mp-footer__col"><h4>Kontakt</h4><p><a href="mailto:info@megaprice.sk">info@megaprice.sk</a><br>+421 xxx xxx xxx</p></div>
        </div></div></div>
        <div class="mp-footer__bottom"><p>Â© 2026 megaprice. VÅ¡etky prÃ¡va vyhradenÃ©.</p><div class="mp-footer__links"><a href="/obchodne-podmienky">ObchodnÃ© podmienky</a><a href="/ochrana-udajov">GDPR</a><a href="/cookies">Cookies</a></div></div>
    </footer>

    <!-- BOTTOM NAV -->
    <nav class="mp-bottom-nav">
        <a href="/" class="mp-bottom-nav__item" class:is-active={$page.url.pathname === '/'}><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg><span>Domov</span></a>
        <a href="/kategorie" class="mp-bottom-nav__item"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg><span>KategÃ³rie</span></a>
        <a href="/oblubene" class="mp-bottom-nav__item"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg><span>ObÄ¾ÃºbenÃ©</span></a>
        <a href="/ucet" class="mp-bottom-nav__item"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg><span>ÃšÄet</span></a>
    </nav>

    <!-- MOBILE MENU -->
    {#if mobileMenuOpen}
        <div class="mp-mobile-overlay" on:click={closeMobileMenu}></div>
        <div class="mp-mobile-menu">
            <div class="mp-mobile-menu__header">
                <span class="mp-mobile-menu__title">KategÃ³rie</span>
                <button class="mp-mobile-menu__close" on:click={closeMobileMenu}><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
            </div>
            <div class="mp-mobile-menu__content">
                {#each navCategories as cat}
                    <a href={"/kategoria/" + (cat.slug || cat.id)} class="mp-mobile-menu__link" on:click={closeMobileMenu}>
                        <span class="mp-mobile-menu__icon">{getCatEmoji(cat.name)}</span>{cat.name}
                    </a>
                {/each}
            </div>
        </div>
    {/if}
</div>
{/if}

<style>
/* â•â•â• GLOBALS â•â•â• */
:global(*){box-sizing:border-box;margin:0;padding:0}
:global(body){font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f8fafc;color:#1f2937;line-height:1.5}
:global(a){text-decoration:none;color:inherit}
:global(img){max-width:100%;height:auto}
:global(button){cursor:pointer;font-family:inherit}
.mp-site{min-height:100vh;display:flex;flex-direction:column}

/* â•â•â• HEADER â•â•â• */
.mp-header{background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.08);position:relative;z-index:1000}
.mp-header__inner{display:flex;align-items:center;gap:24px;padding:12px 20px;max-width:1400px;margin:0 auto}
.mp-header__logo{flex-shrink:0}
.mp-header__logo-text{font-size:24px;font-weight:700;color:#ff6b35}
.mp-search{flex:1;max-width:600px;margin:0 auto;display:flex}
.mp-search__input{flex:1;padding:12px 20px;border:2px solid #e5e7eb;border-right:none;border-radius:10px 0 0 10px;font-size:15px;outline:none;transition:border-color .2s}
.mp-search__input:focus{border-color:#ff6b35}
.mp-search__input::placeholder{color:#9ca3af}
.mp-search__btn{padding:12px 24px;background:#ff6b35;border:none;border-radius:0 10px 10px 0;color:#fff;font-weight:600;font-size:14px;display:flex;align-items:center;gap:8px;transition:background .2s}
.mp-search__btn:hover{background:#e55a2b}
.mp-header__actions{display:flex;gap:6px;flex-shrink:0}
.mp-header__action{display:flex;flex-direction:column;align-items:center;gap:3px;padding:8px 12px;border-radius:10px;color:#4b5563;font-size:11px;font-weight:500;transition:all .2s}
.mp-header__action:hover{background:#f3f4f6;color:#ff6b35}
.mp-header__action--cart{background:#ff6b35;color:#fff !important}
.mp-header__action--cart:hover{background:#e55a2b}
.mp-header__action-icon{position:relative;display:flex}
.mp-header__action-badge{position:absolute;top:-6px;right:-6px;background:#ff6b35;color:#fff;font-size:10px;width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center}
.mp-header__action-badge--blue{background:#3b82f6}
@media(max-width:768px){
    .mp-header__inner{gap:12px;padding:10px 16px}
    .mp-search{display:none}
    .mp-header__actions{gap:4px}
    .mp-header__action{padding:8px}
    .mp-header__action span:last-child{display:none}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* CATEGORY NAV - CORE                         */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cn{background:#fff;border-bottom:1px solid #e5e7eb;position:sticky;top:0;z-index:998;transition:all .3s cubic-bezier(.4,0,.2,1)}
.cn--collapsed{box-shadow:0 2px 12px rgba(0,0,0,.06)}
.cn__wrap{max-width:1400px;margin:0 auto;padding:0 20px;position:relative}

.cn__row{display:flex;gap:6px;padding:10px 0;overflow-x:auto;scrollbar-width:none;-webkit-overflow-scrolling:touch}
.cn__row::-webkit-scrollbar{display:none}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* PILLS â€” rounded chip-style (default)        */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cn-pill{display:flex;align-items:center;gap:8px;padding:6px 14px 6px 6px;background:#f3f4f6;border:1.5px solid transparent;border-radius:100px;font-size:13px;font-weight:600;color:#374151;white-space:nowrap;transition:all .2s cubic-bezier(.4,0,.2,1);flex-shrink:0}
.cn-pill:hover{background:#fff5f0;border-color:#ff6b35;color:#ff6b35;transform:translateY(-1px);box-shadow:0 3px 10px rgba(255,107,53,.12)}
.cn-pill--active{background:#ff6b35 !important;color:#fff !important;border-color:#ff6b35 !important;box-shadow:0 3px 10px rgba(255,107,53,.25)}
.cn-pill__ico{width:28px;height:28px;border-radius:50%;background:#fff;display:flex;align-items:center;justify-content:center;overflow:hidden;flex-shrink:0;transition:all .2s}
.cn-pill__ico img{width:100%;height:100%;object-fit:cover}
.cn-pill__ico span{font-size:14px}
.cn-pill--active .cn-pill__ico{background:rgba(255,255,255,.25)}
.cn-pill__txt{line-height:1}
.cn-pill__plus{font-size:11px;font-weight:700;color:#ff6b35}
.cn-pill--more{background:transparent;border:1.5px dashed #ff6b35;color:#ff6b35;cursor:pointer;gap:6px}
.cn-pill--more:hover{background:#fff5f0;border-style:solid}
.cn-pill--more .cn-pill__ico{background:#fff5f0}
.cn-pill__chevron{transition:transform .2s;flex-shrink:0}
.cn-pill__chevron--open{transform:rotate(180deg)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* ICONS â€” circle image + label below          */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cn__row--icons{gap:2px;padding:10px 0 8px}
.cn-ico{display:flex;flex-direction:column;align-items:center;gap:4px;padding:4px 10px;border-radius:12px;transition:all .2s;flex-shrink:0;border:none;background:transparent;cursor:pointer;text-decoration:none;color:inherit}
.cn-ico:hover{background:#fef7f0}
.cn-ico--active .cn-ico__circle{border-color:#ff6b35;box-shadow:0 0 0 3px rgba(255,107,53,.15)}
.cn-ico__circle{width:48px;height:48px;border-radius:50%;border:2px solid #e5e7eb;background:#fff;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:all .2s}
.cn-ico:hover .cn-ico__circle{border-color:#ff6b35;transform:scale(1.08)}
.cn-ico__circle img{width:100%;height:100%;object-fit:cover}
.cn-ico__circle span{font-size:18px}
.cn-ico__circle--more{border-style:dashed;border-color:#ff6b35;color:#ff6b35}
.cn-ico__name{font-size:11px;font-weight:500;color:#6b7280;max-width:72px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center}
.cn-ico:hover .cn-ico__name{color:#ff6b35}
.cn-ico--more{border:none;background:none}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* MINIMAL â€” clean text-only with underline    */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cn__row--min{gap:0;padding:0}
.cn-min{position:relative;padding:14px 18px;font-size:13.5px;font-weight:600;color:#4b5563;white-space:nowrap;transition:color .2s;flex-shrink:0;background:none;border:none;display:flex;align-items:center;gap:4px;cursor:pointer}
.cn-min::after{content:'';position:absolute;bottom:0;left:18px;right:18px;height:2.5px;background:#ff6b35;border-radius:2px 2px 0 0;transform:scaleX(0);transition:transform .25s cubic-bezier(.4,0,.2,1)}
.cn-min:hover{color:#ff6b35}
.cn-min:hover::after{transform:scaleX(1)}
.cn-min--active{color:#ff6b35}
.cn-min--active::after{transform:scaleX(1)}
.cn-min--more{color:#ff6b35;font-weight:700;cursor:pointer}
.cn-min--more::after{display:none}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* CARDS â€” small bordered cards                */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cn__row--cards{gap:8px;padding:10px 0}
.cn-card{display:flex;align-items:center;gap:10px;padding:8px 14px 8px 8px;background:#f8fafc;border:1px solid #e5e7eb;border-radius:12px;flex-shrink:0;transition:all .2s;cursor:pointer}
.cn-card:hover{border-color:#ff6b35;background:#fff;box-shadow:0 4px 14px rgba(0,0,0,.06);transform:translateY(-2px)}
.cn-card--active{border-color:#ff6b35;background:#fff5f0}
.cn-card__img{width:34px;height:34px;border-radius:8px;background:#fff;display:flex;align-items:center;justify-content:center;overflow:hidden;flex-shrink:0}
.cn-card__img img{width:100%;height:100%;object-fit:cover;border-radius:8px}
.cn-card__img span{font-size:15px}
.cn-card__name{font-size:13px;font-weight:600;color:#374151;white-space:nowrap}
.cn-card:hover .cn-card__name{color:#ff6b35}
.cn-card--more{border-style:dashed;border-color:#ff6b35;background:transparent}
.cn-card--more .cn-card__img{background:#fff5f0;color:#ff6b35;font-weight:700;font-size:12px}
.cn-card--more .cn-card__name{color:#ff6b35}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* MEGA MENU                                   */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.mn{position:absolute;left:0;right:0;top:100%;background:#fff;border-top:1px solid #e5e7eb;box-shadow:0 20px 50px rgba(0,0,0,.12);z-index:999;animation:mnDrop .2s ease}
@keyframes mnDrop{from{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:translateY(0)}}
.mn__grid{display:grid;grid-template-columns:repeat(4,1fr);gap:4px 16px;max-width:1400px;margin:0 auto;padding:20px 24px;max-height:50vh;overflow-y:auto}
.mn__col{padding:8px 0;border-bottom:1px solid #f3f4f6}
.mn__col:nth-last-child(-n+4){border-bottom:none}
.mn__sub{display:flex;align-items:center;gap:12px;padding:4px 0;margin-bottom:4px}
.mn__sub:hover .mn__sub-name{color:#ff6b35}
.mn__sub-img{width:40px;height:40px;display:flex;align-items:center;justify-content:center;overflow:hidden;flex-shrink:0}
.mn__sub-img img{width:100%;height:100%;object-fit:contain}
.mn__sub-img span{font-size:14px;font-weight:600;color:#9ca3af;width:36px;height:36px;background:#f3f4f6;border-radius:6px;display:flex;align-items:center;justify-content:center}
.mn__sub-name{font-size:14px;font-weight:700;color:#1f2937}
.mn__links{display:flex;flex-wrap:wrap;gap:0;padding:2px 0 6px;line-height:1.7}
.mn__link{font-size:12px;color:#6b7280;transition:color .15s;white-space:nowrap}
.mn__link::before{content:'â€¢';color:#d1d5db;margin:0 5px}
.mn__link:hover{color:#ff6b35}
.mn__link--more{color:#ff6b35;font-weight:600}
@media(max-width:1200px){.mn__grid{grid-template-columns:repeat(3,1fr)}}
@media(max-width:900px){.mn__grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:768px){.mn{display:none}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* ALL CATEGORIES DROPDOWN                     */
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cn-drop__overlay{position:fixed;inset:0;background:rgba(0,0,0,.3);z-index:1000;animation:fadeIn .15s}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.cn-drop{position:absolute;top:calc(100% + 4px);left:50%;transform:translateX(-50%);width:92%;max-width:960px;max-height:70vh;background:#fff;border-radius:16px;box-shadow:0 25px 60px rgba(0,0,0,.16);z-index:1001;overflow:hidden;animation:dropSlide .25s cubic-bezier(.4,0,.2,1)}
@keyframes dropSlide{from{opacity:0;transform:translateX(-50%) translateY(-10px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
.cn-drop__head{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid #e5e7eb}
.cn-drop__head h3{font-size:16px;font-weight:700;color:#1f2937}
.cn-drop__head button{background:none;border:none;color:#6b7280;padding:4px;border-radius:8px}
.cn-drop__head button:hover{background:#f3f4f6}
.cn-drop__grid{display:grid;grid-template-columns:repeat(3,1fr);gap:4px;padding:16px;max-height:calc(70vh - 60px);overflow-y:auto}
.cn-drop__item{display:flex;align-items:center;gap:12px;padding:10px 12px;border-radius:10px;transition:all .15s}
.cn-drop__item:hover{background:#fef7f0}
.cn-drop__item-img{width:40px;height:40px;border-radius:10px;background:#f3f4f6;display:flex;align-items:center;justify-content:center;overflow:hidden;flex-shrink:0}
.cn-drop__item-img img{width:100%;height:100%;object-fit:cover;border-radius:10px}
.cn-drop__item-img span{font-size:16px}
.cn-drop__item-name{font-size:14px;font-weight:600;color:#1f2937;display:block}
.cn-drop__item-count{font-size:12px;color:#9ca3af}
@media(max-width:768px){.cn-drop__grid{grid-template-columns:repeat(2,1fr)}.cn-drop{width:95%}}

/* â•â•â• COLLAPSE STATES â•â•â• */
.cn--collapsed .cn__row{padding:6px 0}
.cn--collapsed .cn-pill{padding:4px 10px 4px 4px;font-size:12px}
.cn--collapsed .cn-pill__ico{width:22px;height:22px}
.cn--collapsed .cn-ico__circle{width:34px;height:34px}
.cn--collapsed .cn-ico__name{font-size:9px}
.cn--collapsed .cn-min{padding:10px 14px;font-size:12px}
.cn--collapsed .cn-card{padding:5px 10px 5px 5px}
.cn--collapsed .cn-card__img{width:26px;height:26px}
.cn--collapsed .cn-card__name{font-size:11.5px}

/* â•â•â• FOOTER â•â•â• */
.mp-main{flex:1}
.mp-footer{background:#1f2937;color:#fff;margin-top:auto}
.mp-footer__top{padding:48px 20px}
.mp-footer__inner{max-width:1400px;margin:0 auto}
.mp-footer__grid{display:grid;grid-template-columns:repeat(4,1fr);gap:32px}
.mp-footer__col h4{font-size:14px;font-weight:700;margin-bottom:16px;color:#fff}
.mp-footer__col ul{list-style:none}
.mp-footer__col li{margin-bottom:8px}
.mp-footer__col a{color:rgba(255,255,255,.7);font-size:14px;transition:color .2s}
.mp-footer__col a:hover{color:#fff}
.mp-footer__col p{color:rgba(255,255,255,.7);font-size:14px;line-height:1.8}
.mp-footer__bottom{background:rgba(0,0,0,.2);padding:16px 20px;display:flex;justify-content:space-between;align-items:center;font-size:13px;color:rgba(255,255,255,.6);max-width:1400px;margin:0 auto}
.mp-footer__links{display:flex;gap:20px}
.mp-footer__links a{color:rgba(255,255,255,.6)}
.mp-footer__links a:hover{color:#fff}
@media(max-width:768px){.mp-footer__grid{grid-template-columns:repeat(2,1fr);gap:24px}.mp-footer__top{padding:32px 20px}.mp-footer{padding-bottom:70px}.mp-footer__bottom{flex-direction:column;gap:12px;text-align:center}}

/* â•â•â• BOTTOM NAV â•â•â• */
.mp-bottom-nav{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid #e5e7eb;display:none;justify-content:space-around;padding:8px 0 calc(8px + env(safe-area-inset-bottom));z-index:1100}
.mp-bottom-nav__item{display:flex;flex-direction:column;align-items:center;gap:2px;padding:4px 12px;color:#6b7280;font-size:10px;font-weight:500}
.mp-bottom-nav__item.is-active,.mp-bottom-nav__item:hover{color:#ff6b35}
@media(max-width:768px){.mp-bottom-nav{display:flex}}

/* â•â•â• MOBILE MENU â•â•â• */
.mp-mobile-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:1200}
.mp-mobile-menu{position:fixed;top:0;left:0;bottom:0;width:300px;max-width:85vw;background:#fff;z-index:1300;display:flex;flex-direction:column;animation:slideIn .3s ease}
@keyframes slideIn{from{transform:translateX(-100%)}to{transform:translateX(0)}}
.mp-mobile-menu__header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:linear-gradient(135deg,#ff6b35,#e55a2b);color:#fff}
.mp-mobile-menu__title{font-size:18px;font-weight:700}
.mp-mobile-menu__close{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,.2);border:none;border-radius:50%;color:#fff}
.mp-mobile-menu__content{flex:1;overflow-y:auto;padding:8px}
.mp-mobile-menu__link{display:flex;align-items:center;gap:12px;padding:14px 16px;border-radius:10px;color:#374151;font-weight:500;font-size:15px}
.mp-mobile-menu__link:hover{background:#f3f4f6}
.mp-mobile-menu__icon{font-size:18px}
</style>
