{"version":3,"file":"auth-Dc0Yhpkc.js","sources":["../../../.svelte-kit/adapter-node/chunks/auth.js"],"sourcesContent":["import { w as writable } from \"./index.js\";\nimport { B as BROWSER } from \"./false.js\";\nconst browser = BROWSER;\nconst initialState = {\n  isLoggedIn: false,\n  token: null,\n  vendor: null,\n  shop: null,\n  loading: true\n};\nfunction createAuthStore() {\n  const { subscribe, set, update } = writable(initialState);\n  async function checkAuth(token) {\n    const API_BASE = \"http://pc4kcc0ko0k0k08gk840cos0.46.224.7.54.sslip.io/api/v1\";\n    try {\n      const res = await fetch(`${API_BASE}/auth/me`, {\n        headers: { \"Authorization\": `Bearer ${token}` }\n      });\n      if (res.ok) {\n        const data = await res.json();\n        if (data.success) {\n          set({\n            isLoggedIn: true,\n            token,\n            vendor: data.data.vendor,\n            shop: data.data.shop,\n            loading: false\n          });\n          return;\n        }\n      }\n      logout();\n    } catch (e) {\n      logout();\n    }\n  }\n  async function login(email, password, rememberMe = false) {\n    const API_BASE = \"http://pc4kcc0ko0k0k08gk840cos0.46.224.7.54.sslip.io/api/v1\";\n    try {\n      const res = await fetch(`${API_BASE}/auth/login`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, password, remember_me: rememberMe })\n      });\n      const data = await res.json();\n      if (data.success) {\n        if (browser) ;\n        set({\n          isLoggedIn: true,\n          token: data.data.token,\n          vendor: data.data.vendor,\n          shop: data.data.shop,\n          loading: false\n        });\n        return { success: true };\n      }\n      return { success: false, error: data.error };\n    } catch (e) {\n      return { success: false, error: \"Chyba pripojenia\" };\n    }\n  }\n  async function register(data) {\n    const API_BASE = \"http://pc4kcc0ko0k0k08gk840cos0.46.224.7.54.sslip.io/api/v1\";\n    const fullName = `${data.first_name} ${data.last_name}`.trim();\n    try {\n      const res = await fetch(`${API_BASE}/auth/register`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          email: data.email,\n          password: data.password,\n          name: fullName,\n          // Pre stĺpec \"name\" v DB\n          company_name: data.shop_name,\n          // Použijeme shop_name ako company_name\n          contact_person: fullName,\n          // Kontaktná osoba\n          shop_name: data.shop_name,\n          shop_url: data.shop_url\n        })\n      });\n      const result = await res.json();\n      if (result.success) {\n        return { success: true };\n      }\n      return { success: false, error: result.error };\n    } catch (e) {\n      return { success: false, error: \"Chyba pripojenia\" };\n    }\n  }\n  function logout() {\n    set({\n      isLoggedIn: false,\n      token: null,\n      vendor: null,\n      shop: null,\n      loading: false\n    });\n  }\n  return {\n    subscribe,\n    login,\n    register,\n    logout,\n    checkAuth\n  };\n}\ncreateAuthStore();\n"],"names":[],"mappings":"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"}